@model AtletaAsdericel.ViewModels.DirigenteCreateViewModel
@using AtletaAsdericel.Models.Enum
@{
    ViewBag.Title = "Create";
}

<h2>Cadastro de Dirigentes Técnicos</h2>
<hr />

<form class="user" asp-action="Create">
    @Html.AntiForgeryToken() <!-- Gera o token anti-falsificação -->

    <div class="form-group row mt-4">
        <div class="col-sm-3">
            <input type="text" asp-for=Nome class="form-control form-control-user" placeholder="Nome" required>
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=NomeSocial class="form-control form-control-user" placeholder="Nome Social">
        </div>
        <div class="col-sm-3 ">
            <input type="text" asp-for=NomeConhecido class="form-control form-control-user" placeholder="Apelido">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for="DataNascimento" class="form-control form-control-user date" required placeholder="Data de Nascimento"
                   value="@(Model.DataNascimento != DateTime.MinValue ? Model.DataNascimento.ToString("dd/MM/yyyy") : string.Empty)">
        </div>
    </div>

    <div class="form-group row">
        <div class="col-sm-3">
            <input type="text" asp-for="Mae" id="dt" class="form-control form-control-user" placeholder="Nome da mãe" required>
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for="Pai" id="dt" class="form-control form-control-user" placeholder="Nome do Pai">
        </div>
        <div class="col-md-3">
            <select asp-for="EstadoCivil" type="text" asp-items="Html.GetEnumSelectList<EStadoCivil>()" class="form-control rounded-pill" placeholder="Selecione" required>
                <option value="">Selecione o estado civil ...</option>
            </select>
        </div>
        <div class="col-md-3">
            <select asp-for="Sexo" type="text" asp-items="Html.GetEnumSelectList<ESexo>()" class="form-control rounded-pill" placeholder="Selecione" required>
                <option value="">Selecione o sexo ...</option>
            </select>
        </div>
        <div class="col-md-3">
            <select asp-for="FederacaoId" type="text" required asp-items="new SelectList(Model.Federacoes, nameof(Federacao.Id), nameof(Federacao.Sigla))"
                    class="form-control rounded-pill" placeholder="Selecione">
                <option value="">Selecione a Federação ...</option>
            </select>
        </div>
    </div>

    <div class="form-group row">
        <div class="col-sm-3">
            <input type="text" asp-for=Profissao class="form-control form-control-user " placeholder="Profissao">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=CPF class="form-control form-control-user cpf" placeholder="Cpf" required>
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=CREF class="form-control form-control-user " placeholder="CREF">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Passaporte class="form-control form-control-user " placeholder=" Nº Passaporte">
        </div>
    </div>

    <div class="form-group row">
        <div class="col-sm-3">
            <input type="text" asp-for=CIN_RG class="form-control form-control-user " placeholder="Rg" required>
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=OrgaoEmissor class="form-control form-control-user " placeholder="Orgão emissor" required>
        </div>

        <div class="col-sm-3">
            <input type="text" asp-for="DataExpedicao" class="form-control form-control-user dtExpedicao" required placeholder="Data de Expedição"
                   value="@(Model.DataExpedicao != DateTime.MinValue ? Model.DataExpedicao.ToString("dd/MM/yyyy") : string.Empty)">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=NumeroSus class="form-control form-control-user " placeholder="Numero do Sus">
        </div>
    </div>

    <div class="form-group row">
        <div class="col-md-3">
            <select asp-for="TipoSanguineo" type="text" asp-items="Html.GetEnumSelectList<ETipoSanguineo>()" class="form-control rounded-pill" placeholder="Selecione">
                <option value="">Selecione o Tipo Sanguíneo ...</option>
            </select>
        </div>
        <div class="col-md-3">
            <select asp-for="Ensino" type="text" asp-items="Html.GetEnumSelectList<EEnsino>()" class="form-control rounded-pill" required placeholder="Selecione">
                <option value="">Selecione o nivel de ensino ...</option>
            </select>
        </div>
    </div>

    <label>Dados endereço</label>
    <div class="form-group row">
        <div class="col-sm-3">
            <input type="text" asp-for="Endereco.Cep" class="form-control form-control-user" required placeholder="Cep">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Endereco.Logradouro class="form-control form-control-user" placeholder="Rua">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Endereco.Bairro class="form-control form-control-user" placeholder="Bairro">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Endereco.Numero class="form-control form-control-user" placeholder="Número" required>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-3">
            <input type="text" asp-for=Endereco.Localidade class="form-control form-control-user" placeholder="Cidade">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Endereco.Uf class="form-control form-control-user" placeholder="Estado">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Endereco.Pais class="form-control form-control-user" placeholder="País" required>
        </div>
    </div>
    <label>Dados da Modalidade</label>
    <div class="form-group row">
        <div class="col-md-3">
            <select asp-for="ModalidadeId" required type="text" asp-items="new SelectList(Model.Modalidades, nameof(Modalidade.Id), nameof(Modalidade.Nome))" class="form-control rounded-pill" placeholder="Selecione">
                <option value="">Selecione a modalidade ...</option>
            </select>
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Peso required class="form-control form-control-user" placeholder="Peso">
        </div>
        <div class="col-sm-3">
            <input type="text" asp-for=Altura required class="form-control form-control-user" placeholder="Altura">
        </div>
        <div class="col-sm-3">
            <select asp-for="Camisa" type="text" asp-items="Html.GetEnumSelectList<ECamisa>()" class="form-control rounded-pill" placeholder="Selecione">
                <option value="">Selecione o tamanho da Camisa ...</option>
            </select>
        </div>
        <div class="col-sm-3">
            <select asp-for="Calca" type="text" asp-items="Html.GetEnumSelectList<ECalca>()" class="form-control rounded-pill" placeholder="Selecione">
                <option value="">Selecione o tamanho da Calça ...</option>
            </select>
        </div>
    </div>
    <button type="submit" class="btn btn-primary btn-user btn-block ">
        Gravar
    </button>
</form>

<div>
    @Html.ActionLink("Voltar para Lista", "Index")
</div>

@*@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}*@
<script>
    $(document).ready(function () {
        $('#Endereco_Cep').on('input', function () {
            $(this).val($(this).val().replace(/\D/g, '')); // Remove todos os caracteres não numéricos
        });
    });

    $(document).ready(function () {
        $('#Endereco_Cep').on('blur', function () {
            // Pega o valor do campo de CEP
            const cep = this.value;

            $.getJSON(`https://viacep.com.br/ws/${cep}/json/`, function (data) {
                // Atualiza os campos de endereço se a busca retornar com sucesso
                if (!data.erro) {
                    $('#Endereco_Bairro').val(data.bairro);
                    $('#Endereco_Logradouro').val(data.logradouro);
                    $('#Endereco_Localidade').val(data.localidade);
                    $('#Endereco_Uf').val(data.uf);
                } else {
                    // Limpa os campos de endereço se o CEP não for encontrado
                    $('#Endereco_Bairro').val('');
                    $('#Endereco_Logradouro').val('');
                    $('#Endereco_Localidade').val('');
                    $('#Endereco_Estado').val('');
                }
            });
        });
    });
</script>